import{_ as Q,c as i,a as C,b as T,o as n,d as s,r as m,t as O,e as ae,F,n as z,f as l,w as N,u as g,l as se,g as q,h as w,i as le,j as P,k as H,m as U,E as R,p as ne,q as oe,s as ce,v as ie,x as re,y as ue,z as de,A as ve,B as he,C as pe,D as me,G as fe}from"./index-BVCzLaAQ.js";const ye=["data-path"],_e={key:1,class:"spacer"},ge={class:"node-content-inner"},ke={key:0,class:"node-key-box"},$e=["innerHTML"],xe={key:0,class:"item-tag"},be=["innerHTML"],Ce={key:0},we={key:2,class:"bracket"},Me={class:"node-ops"},Oe={key:2,class:"summary"},Ne={key:0,class:"node-children"},Se={key:1,class:"node-footer"},Ve={class:"bracket"},Le={key:0},ze={__name:"JsonNode",props:["data","label","isLast","path","searchQuery","searchOptions","currentActivePath","match-list"],emits:["delete-node"],setup(o,{emit:$}){const t=o,k=m(!0),M=T(()=>t.data!==null&&typeof t.data=="object"),f=T(()=>Array.isArray(t.data)),x=(p,c=!1)=>{let r=c?p:typeof p=="string"?`"${p}"`:String(p);if(!c&&t.searchOptions.omitFields&&t.label&&t.searchOptions.omitFields.split(",").includes(t.label))return'"..."';if(!t.searchQuery)return r;try{let d=t.searchQuery;t.searchOptions.isRegex||(d=d.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")),t.searchOptions.fullWord&&(d=`\\b${d}\\b`);const b=new RegExp(`(${d})`,t.searchOptions.matchCase?"g":"gi");return r.replace(b,'<mark class="hl-mark">$1</mark>')}catch{return r}},S=T(()=>!t.searchOptions.onlyShowMatches||!t.searchQuery?!0:t.matchList.some(p=>p.startsWith(t.path))),V=()=>{navigator.clipboard.writeText(t.path),R.success("路径已复制")},L=()=>{navigator.clipboard.writeText(JSON.stringify(t.data,null,2)),R.success("内容已复制")};return(p,c)=>{const r=w("el-icon"),d=w("JsonNode",!0);return S.value?(n(),i("div",{key:0,class:"node-item","data-path":o.path},[s("div",{class:z(["node-row",{"active-search-item":o.currentActivePath===o.path}])},[M.value?(n(),i("span",{key:0,class:"toggle",onClick:c[0]||(c[0]=b=>k.value=!k.value)},O(k.value?"▼":"▶"),1)):(n(),i("span",_e)),s("div",ge,[o.label?(n(),i("span",ke,[s("span",{class:"node-key",innerHTML:x(o.label,!0)},null,8,$e),f.value?(n(),i("span",xe,"["+O(o.data.length)+"]",1)):C("",!0),c[3]||(c[3]=ae(": ",-1))])):C("",!0),M.value?(n(),i("span",we,O(f.value?"[":"{"),1)):(n(),i(F,{key:1},[s("span",{class:z(["node-val",typeof o.data]),innerHTML:x(o.data)},null,10,be),o.isLast?C("",!0):(n(),i("span",Ce,","))],64)),s("span",Me,[l(r,{onClick:q(V,["stop"])},{default:N(()=>[l(g(se))]),_:1}),l(r,{onClick:q(L,["stop"])},{default:N(()=>[l(g(le))]),_:1}),l(r,{onClick:c[1]||(c[1]=q(b=>p.$emit("delete-node",o.path),["stop"])),color:"#f87171"},{default:N(()=>[l(g(P))]),_:1})])]),M.value&&!k.value?(n(),i("span",Oe," ... "+O(f.value?"]":"}"),1)):C("",!0)],2),M.value&&k.value?(n(),i("div",Ne,[(n(!0),i(F,null,H(o.data,(b,y,B)=>(n(),U(d,{key:y,data:b,label:f.value?null:y,path:o.path+(f.value?"["+y+"]":"."+y),"is-last":B===Object.keys(o.data).length-1,"search-query":o.searchQuery,"search-options":o.searchOptions,"current-active-path":o.currentActivePath,"match-list":p.matchList,onDeleteNode:c[2]||(c[2]=W=>p.$emit("delete-node",W))},null,8,["data","label","path","is-last","search-query","search-options","current-active-path","match-list"]))),128))])):C("",!0),M.value&&k.value?(n(),i("div",Se,[s("span",Ve,O(f.value?"]":"}"),1),o.isLast?C("",!0):(n(),i("span",Le,","))])):C("",!0)],8,ye)):C("",!0)}}},Ae=Q(ze,[["__scopeId","data-v-2ce91631"]]),Je={class:"main-layout"},Te={class:"toolbar"},Ee={class:"editor-wrapper"},Fe={class:"line-nums"},Re={class:"pane pane-right"},Be={class:"toolbar"},We={class:"search-group"},De={class:"search-options"},qe={class:"match-count"},Ie={class:"action-icons-inline"},Qe={class:"viewer-wrapper",id:"json-viewer-container"},Pe={key:0,class:"tree-root"},He={__name:"JsonFormatter",setup(o){const $=m(""),t=m(null),k=m(""),M=m(450),f=m(!1),x=m(""),S=m(!1),V=m(!1),L=m(!1),p=m(!1),c=m([]),r=m(-1),d=T(()=>c.value.length),b=a=>{a==="isRegex"&&(S.value=!S.value),a==="matchCase"&&(V.value=!V.value),a==="fullWord"&&(L.value=!L.value),y()},y=()=>{if(c.value=[],r.value=-1,!x.value||!t.value)return;const a=[],e=B();if(!e)return;const u=(v,_)=>{const A=_.split(/[.\[\]]/).filter(Boolean).pop(),E=A&&A!=="$"&&e.test(A),D=v!==null&&typeof v!="object"&&e.test(String(v));(E||D)&&a.push(_),typeof v=="object"&&v!==null&&Object.keys(v).forEach(J=>{const h=Array.isArray(v)?`${_}[${J}]`:`${_}.${J}`;u(v[J],h)})};u(t.value,"$"),c.value=a,a.length>0&&(r.value=0)},B=()=>{try{let a=x.value;return S.value||(a=a.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")),L.value&&(a=`\\b${a}\\b`),new RegExp(a,V.value?"g":"gi")}catch{return null}},W=()=>{d.value>0&&(r.value=(r.value+1)%d.value,I())},j=()=>{d.value>0&&(r.value=(r.value-1+d.value)%d.value,I())},I=()=>{fe(()=>{const a=document.querySelector(`[data-path="${c.value[r.value]}"]`);a&&a.scrollIntoView({behavior:"smooth",block:"center"})})},G=a=>{const e=a.replace("$","").split(/[.\[\]]/).filter(Boolean);let u=t.value;for(let _=0;_<e.length-1;_++)u=u[e[_]];const v=e[e.length-1];Array.isArray(u)?u.splice(v,1):delete u[v],y()},K=()=>{try{t.value=JSON.parse($.value),y()}catch{R.error("格式错误")}},X=a=>{const e=v=>M.value=v.clientX-50,u=()=>{document.removeEventListener("mousemove",e),document.removeEventListener("mouseup",u)};document.addEventListener("mousemove",e),document.addEventListener("mouseup",u)},Y=T(()=>$.value.split(`
`).length||1),Z=()=>{try{$.value=JSON.stringify(JSON.parse($.value))}catch{}},ee=()=>{$.value="",t.value=null,c.value=[]},te=()=>{navigator.clipboard.writeText(JSON.stringify(t.value,null,2)),R.success("已复制")};return ne($,a=>{try{t.value=JSON.parse(a),y()}catch{}},{immediate:!0}),(a,e)=>{const u=w("el-button"),v=w("el-tooltip"),_=w("el-input"),A=w("el-divider"),E=w("el-icon"),D=w("el-checkbox"),J=w("el-empty");return n(),i("div",{class:z(["json-container",{"is-fullscreen":f.value}])},[s("div",Je,[s("div",{class:"pane pane-left",style:oe({width:M.value+"px"})},[s("div",Te,[l(v,{content:"美化"},{default:N(()=>[l(u,{type:"primary",icon:g(ve),size:"small",onClick:K,circle:""},null,8,["icon"])]),_:1}),l(v,{content:"压缩"},{default:N(()=>[l(u,{icon:g(he),size:"small",onClick:Z,circle:""},null,8,["icon"])]),_:1}),l(_,{modelValue:k.value,"onUpdate:modelValue":e[0]||(e[0]=h=>k.value=h),placeholder:"省略字段: 多个按逗号分隔",size:"small",style:{width:"180px"},clearable:""},null,8,["modelValue"]),l(u,{icon:g(P),size:"small",onClick:ee,circle:""},null,8,["icon"])]),s("div",Ee,[s("div",Fe,[(n(!0),i(F,null,H(Y.value,h=>(n(),i("div",{key:h},O(h),1))),128))]),ce(s("textarea",{"onUpdate:modelValue":e[1]||(e[1]=h=>$.value=h),class:"editor-input",spellcheck:"false"},null,512),[[ie,$.value]])])],4),s("div",{class:"resizer",onMousedown:X},null,32),s("div",Re,[s("div",Be,[s("div",We,[l(_,{modelValue:x.value,"onUpdate:modelValue":e[5]||(e[5]=h=>x.value=h),placeholder:"输入搜索内容...",size:"small",style:{width:"320px"},clearable:"",onInput:y},{suffix:N(()=>[s("div",De,[s("span",{class:z(["opt-icon",{active:S.value}]),onClick:e[2]||(e[2]=h=>b("isRegex")),title:"正则表达式"},".*",2),s("span",{class:z(["opt-icon",{active:V.value}]),onClick:e[3]||(e[3]=h=>b("matchCase")),title:"区分大小写"},"Cc",2),s("span",{class:z(["opt-icon",{active:L.value}]),onClick:e[4]||(e[4]=h=>b("fullWord")),title:"全字匹配"},"W",2),x.value?(n(),i(F,{key:0},[l(A,{direction:"vertical"}),s("span",qe,O(d.value>0?r.value+1:0)+"/"+O(d.value),1),l(E,{class:"nav-icon",onClick:j},{default:N(()=>[l(g(pe))]),_:1}),l(E,{class:"nav-icon",onClick:W},{default:N(()=>[l(g(me))]),_:1})],64)):C("",!0)])]),_:1},8,["modelValue"]),l(D,{modelValue:p.value,"onUpdate:modelValue":e[6]||(e[6]=h=>p.value=h),label:"仅展示匹配",size:"small",onChange:y},null,8,["modelValue"]),s("div",Ie,[l(u,{icon:g(re),size:"small",onClick:te,circle:""},null,8,["icon"]),l(u,{icon:f.value?g(ue):g(de),size:"small",onClick:e[7]||(e[7]=h=>f.value=!f.value),circle:""},null,8,["icon"])])])]),s("div",Qe,[t.value?(n(),i("div",Pe,[l(Ae,{data:t.value,"is-last":!0,path:"$","search-query":x.value,"search-options":{isRegex:S.value,matchCase:V.value,fullWord:L.value,onlyShowMatches:p.value,omitFields:k.value},"current-active-path":c.value[r.value],"match-list":c.value,onDeleteNode:G},null,8,["data","search-query","search-options","current-active-path","match-list"])])):(n(),U(J,{key:1,description:"无数据"}))])])])],2)}}},je=Q(He,[["__scopeId","data-v-e500c726"]]);export{je as default};
